<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Chat Protocol (SCP) - Project Documentation</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>🌐 Simple Chat Protocol (SCP)</h1>
      <p class="subtitle">Design Your Own Protocol - Computer Networks Project</p>
      <p class="subtitle" style="margin-top: 10px; font-size: 0.95em;">A Custom Application-Layer Protocol with Reliable Message Delivery</p>
    </header>

    <nav class="nav-tabs">
      <button class="tab-btn active" data-tab="overview">Overview</button>
      <button class="tab-btn" data-tab="protocol">Protocol Design</button>
      <button class="tab-btn" data-tab="implementation">C Implementation</button>
      <button class="tab-btn" data-tab="simulator">Live Simulator</button>
      <button class="tab-btn" data-tab="results">Results & Testing</button>
      <button class="tab-btn" data-tab="conclusion">Conclusion</button>
    </nav>

    <!-- OVERVIEW TAB -->
    <div id="overview" class="tab-content active">
      <div class="section">
        <h2>📋 Project Overview</h2>
        
        <h3>Aim</h3>
        <p>To design and implement a custom application-layer communication protocol called <span class="highlight">Simple Chat Protocol (SCP)</span> that enables reliable message exchange between a client and server using C programming language over TCP/IP sockets.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Design a custom message format with protocol headers and data fields</li>
          <li>Implement connection establishment and termination procedures</li>
          <li>Create acknowledgment (ACK) mechanism for reliable delivery</li>
          <li>Handle timeouts and retransmission logic</li>
          <li>Demonstrate error handling and packet loss scenarios</li>
          <li>Build interactive visualization to understand protocol behavior</li>
        </ul>

        <h3>Tools & Technologies</h3>
        <table>
          <tr>
            <th>Component</th>
            <th>Technology</th>
            <th>Purpose</th>
          </tr>
          <tr>
            <td>Core Implementation</td>
            <td>C Language</td>
            <td>Protocol logic, socket programming</td>
          </tr>
          <tr>
            <td>Network Layer</td>
            <td>TCP Sockets</td>
            <td>Reliable byte-stream transport</td>
          </tr>
          <tr>
            <td>Compiler</td>
            <td>GCC (Linux) / MinGW (Windows)</td>
            <td>Building executables</td>
          </tr>
          <tr>
            <td>Visualization</td>
            <td>HTML/CSS/JavaScript</td>
            <td>Interactive protocol simulator</td>
          </tr>
        </table>

        <h3>Theory & Background</h3>
        
        <h4>What is a Communication Protocol?</h4>
        <p>A communication protocol is a system of rules that allows two or more entities to transmit information. It defines:</p>
        <ul>
          <li><strong>Syntax:</strong> Structure and format of data (message format)</li>
          <li><strong>Semantics:</strong> Meaning of each section of bits (what each field represents)</li>
          <li><strong>Timing:</strong> When to send data and how fast (synchronization)</li>
        </ul>

        <h4>OSI Model Context</h4>
        <p>SCP operates at the <span class="highlight">Application Layer (Layer 7)</span> of the OSI model, similar to HTTP, FTP, or SMTP. It uses TCP (Transport Layer) for underlying reliable communication.</p>

        <h4>Key Concepts in SCP</h4>
        <div class="flow-step">
          <strong>1. Message Format:</strong> Structured packets with version, type, ID, and payload
        </div>
        <div class="flow-step">
          <strong>2. Acknowledgments (ACK):</strong> Server confirms receipt of each message
        </div>
        <div class="flow-step">
          <strong>3. Timeouts & Retries:</strong> Client resends if ACK not received within timeout period
        </div>
        <div class="flow-step">
          <strong>4. Connection Management:</strong> Proper setup (HELLO) and teardown (BYE) phases
        </div>

        <div class="success">
          <strong>💡 Learning Outcome:</strong> By implementing SCP, you understand how application protocols work at a fundamental level, including reliability mechanisms that protocols like TCP provide at lower layers.
        </div>
      </div>
    </div>

    <!-- PROTOCOL DESIGN TAB -->
    <div id="protocol" class="tab-content">
      <div class="section">
        <h2>🔧 Protocol Design Specification</h2>

        <h3>SCP Message Format</h3>
        <p>Every SCP message follows this standardized format:</p>
        
        <div class="protocol-diagram">
<pre>
┌─────────────────────────────────────────────────────────────┐
│  SCP/1.0 | MSG_TYPE | id=MESSAGE_ID | PAYLOAD_DATA         │
└─────────────────────────────────────────────────────────────┘

Components:
  • SCP/1.0      → Protocol version identifier
  • MSG_TYPE     → Message type (HELLO, MSG, ACK, BYE, ERROR)
  • id=XXX       → Unique message identifier (integer)
  • PAYLOAD_DATA → Actual message content or status
</pre>
        </div>

        <h3>Message Types</h3>
        <table>
          <tr>
            <th>Type</th>
            <th>Direction</th>
            <th>Purpose</th>
            <th>Example</th>
          </tr>
          <tr>
            <td><strong>HELLO</strong></td>
            <td>Client → Server</td>
            <td>Initiate connection</td>
            <td><code>SCP/1.0 | HELLO | id=0 | ClientName</code></td>
          </tr>
          <tr>
            <td><strong>MSG</strong></td>
            <td>Client → Server</td>
            <td>Send chat message</td>
            <td><code>SCP/1.0 | MSG | id=1 | Hello World</code></td>
          </tr>
          <tr>
            <td><strong>ACK</strong></td>
            <td>Server → Client</td>
            <td>Acknowledge receipt</td>
            <td><code>SCP/1.0 | ACK | id=1 | MSG_RECEIVED</code></td>
          </tr>
          <tr>
            <td><strong>BYE</strong></td>
            <td>Client → Server</td>
            <td>Terminate connection</td>
            <td><code>SCP/1.0 | BYE | id=99 | DISCONNECT</code></td>
          </tr>
          <tr>
            <td><strong>ERROR</strong></td>
            <td>Server → Client</td>
            <td>Report errors</td>
            <td><code>SCP/1.0 | ERROR | id=1 | INVALID_FORMAT</code></td>
          </tr>
        </table>

        <h3>Protocol Flow Diagram</h3>
        <div class="protocol-diagram">
<pre>
CLIENT                                    SERVER
  │                                         │
  │──── HELLO (id=0) ──────────────────────>│  Connection Setup
  │<──── ACK (id=0) ────────────────────────│
  │                                         │
  │──── MSG (id=1, "Hello") ───────────────>│  Message Transfer
  │<──── ACK (id=1) ────────────────────────│
  │                                         │
  │──── MSG (id=2, "How are you?") ────────>│
  │  X   (packet lost)                      │  Timeout!
  │                                         │
  │──── MSG (id=2, "How are you?") ────────>│  Retry
  │<──── ACK (id=2) ────────────────────────│
  │                                         │
  │──── BYE (id=3) ─────────────────────────>│  Termination
  │<──── ACK (id=3) ────────────────────────│
  │                                         │
  │           [Connection Closed]           │
</pre>
        </div>

        <h3>Reliability Mechanism</h3>
        
        <h4>Acknowledgment System</h4>
        <ol>
          <li>Client sends message with unique ID</li>
          <li>Client starts timeout timer (e.g., 5 seconds)</li>
          <li>Server receives message and sends ACK with same ID</li>
          <li>Client receives ACK → Success, clear timer</li>
          <li>If timeout expires → Resend message (up to MAX_RETRIES)</li>
        </ol>

        <div class="code-block">
<pre>
// Pseudocode for Client Send Logic
send_message(text):
    msg_id = generate_unique_id()
    retries = 0
    
    while retries < MAX_RETRIES:
        send(format_message("MSG", msg_id, text))
        
        if wait_for_ack(msg_id, TIMEOUT):
            print("✓ Message delivered")
            return SUCCESS
        else:
            retries++
            print("⚠ Timeout, retrying...")
    
    print("✗ Failed after max retries")
    return FAILURE
</pre>
        </div>

        <h3>Protocol Parameters</h3>
        <table>
          <tr>
            <th>Parameter</th>
            <th>Default Value</th>
            <th>Description</th>
          </tr>
          <tr>
            <td>VERSION</td>
            <td>1.0</td>
            <td>Protocol version number</td>
          </tr>
          <tr>
            <td>MAX_MESSAGE_SIZE</td>
            <td>1024 bytes</td>
            <td>Maximum payload size</td>
          </tr>
          <tr>
            <td>ACK_TIMEOUT</td>
            <td>5 seconds</td>
            <td>Wait time for acknowledgment</td>
          </tr>
          <tr>
            <td>MAX_RETRIES</td>
            <td>3</td>
            <td>Maximum resend attempts</td>
          </tr>
          <tr>
            <td>PORT</td>
            <td>8080</td>
            <td>Default server port</td>
          </tr>
        </table>

        <div class="warning">
          <strong>⚠️ Important:</strong> In real-world scenarios, protocols would handle sequence numbers, flow control, and congestion control. SCP is simplified for educational purposes.
        </div>
      </div>
    </div>

    <!-- IMPLEMENTATION TAB -->
    <div id="implementation" class="tab-content">
      <div class="section">
        <h2>💻 C Language Implementation</h2>

        <div class="success">
          <strong>📦 Download Complete Source Code:</strong><br>
          <a href="#" class="download-btn" onclick="downloadFile('scp_server.c', getServerCode()); return false;">Download scp_server.c</a>
          <a href="#" class="download-btn" onclick="downloadFile('scp_client.c', getClientCode()); return false;">Download scp_client.c</a>
          <a href="#" class="download-btn" onclick="downloadFile('Makefile', getMakefile()); return false;">Download Makefile</a>
        </div>

        <h3>Project Structure</h3>
        <div class="code-block">
<pre>
scp_project/
├── scp_server.c       # Server implementation
├── scp_client.c       # Client implementation
├── Makefile           # Build configuration
└── README.md          # Documentation
</pre>
        </div>

        <h3>Server Implementation (scp_server.c)</h3>
        <p>The server listens for incoming connections, parses SCP messages, and sends acknowledgments.</p>
        
        <div class="code-block">
<pre>
See the complete server code by clicking the download button above.
Key features:
- Socket creation and binding
- Connection acceptance
- Message parsing
- ACK generation and sending
- Connection lifecycle management
</pre>
        </div>

        <h3>Client Implementation (scp_client.c)</h3>
        <p>The client connects to the server, sends messages, and implements timeout/retry logic.</p>
        
        <div class="code-block">
<pre>
See the complete client code by clicking the download button above.
Key features:
- Server connection
- Message formatting
- Timeout handling with setsockopt()
- Retry mechanism
- ACK validation
</pre>
        </div>

        <h3>Compilation & Execution</h3>
        
        <h4>Build Instructions</h4>
        <div class="code-block">
<pre>
# Linux / macOS
$ make
$ ./scp_server    # Terminal 1
$ ./scp_client    # Terminal 2

# Windows (MinGW)
$ gcc -o scp_server.exe scp_server.c -lws2_32
$ gcc -o scp_client.exe scp_client.c -lws2_32
$ scp_server.exe
$ scp_client.exe
</pre>
        </div>

        <div class="warning">
          <strong>⚠️ Windows Users:</strong> You need to include <code>winsock2.h</code> instead of <code>arpa/inet.h</code> and link with <code>-lws2_32</code>. Also initialize Winsock with <code>WSAStartup()</code>.
        </div>

        <h3>How It Works - Step by Step</h3>
        
        <div class="flow-step">
          <strong>Step 1: Server Setup</strong>
          <ul>
            <li>Server creates a socket using <code>socket()</code></li>
            <li>Binds to port 8080 with <code>bind()</code></li>
            <li>Starts listening with <code>listen()</code></li>
            <li>Waits for client connection with <code>accept()</code></li>
          </ul>
        </div>

        <div class="flow-step">
          <strong>Step 2: Client Connection</strong>
          <ul>
            <li>Client creates socket and connects to server</li>
            <li>Sends HELLO message with username</li>
            <li>Waits for ACK with timeout</li>
            <li>If ACK received, connection established</li>
          </ul>
        </div>

        <div class="flow-step">
          <strong>Step 3: Message Exchange</strong>
          <ul>
            <li>Client formats message in SCP format</li>
            <li>Sends message to server</li>
            <li>Server parses message, processes it</li>
            <li>Server sends ACK back with same message ID</li>
            <li>Client validates ACK matches sent message ID</li>
          </ul>
        </div>

        <div class="flow-step">
          <strong>Step 4: Timeout & Retry Logic</strong>
          <ul>
            <li>Client sets timeout (5 seconds) using <code>setsockopt()</code></li>
            <li>If ACK not received, timeout occurs</li>
            <li>Client retries sending (up to 3 times)</li>
            <li>After max retries, reports failure</li>
          </ul>
        </div>

        <div class="flow-step">
          <strong>Step 5: Disconnection</strong>
          <ul>
            <li>User types "quit"</li>
            <li>Client sends BYE message</li>
            <li>Server acknowledges and closes connection</li>
            <li>Both sides close sockets</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- SIMULATOR TAB -->
    <div id="simulator" class="tab-content">
      <div class="section">
        <h2>🎮 Interactive Protocol Simulator</h2>
        <p>Visualize how SCP works with network delays, packet loss, and retransmissions!</p>

        <div class="controls">
          <h3>Simulation Controls</h3>
          <div class="control-row">
            <label for="delayRange">Network Delay: <strong><span id="delayVal">600</span> ms</strong></label>
            <input id="delayRange" type="range" min="0" max="3000" value="600" />
          </div>
          <div class="control-row">
            <label for="lossRange">Packet Loss: <strong><span id="lossVal">10</span>%</strong></label>
            <input id="lossRange" type="range" min="0" max="100" value="10" />
          </div>
          <div class="control-row">
            <label for="timeoutRange">ACK Timeout: <strong><span id="timeoutVal">2000</span> ms</strong></label>
            <input id="timeoutRange" type="range" min="300" max="8000" value="2000" step="100" />
          </div>
          <div class="control-row">
            <label>
              <input id="lossToggle" type="checkbox" checked /> Enable packet loss simulation
            </label>
          </div>
          <div class="control-row">
            <label for="maxRetries">Max Retries:</label>
            <select id="maxRetries">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3" selected>3</option>
              <option value="5">5</option>
            </select>
          </div>
          <div class="control-row">
            <button id="clearLog" style="width: 100%; padding: 10px;">Clear All Logs</button>
          </div>
        </div>

        <div class="simulator-container">
          <div class="panels">
            <div class="panel" id="clientPanel">
              <div class="panel-title">📱 Client</div>
              <div class="console" id="clientConsole"></div>
              <form id="sendForm" class="send-form">
                <input id="messageInput" type="text" placeholder="Type a message..." required autocomplete="off" />
                <button type="submit">Send</button>
              </form>
            </div>
            
            <div class="panel" id="serverPanel">
              <div class="panel-title">🖥️ Server</div>
              <div class="console" id="serverConsole"></div>
            </div>
          </div>
          <div class="overlay" id="overlay"></div>
          
          <div style="margin-top: 20px;">
            <h4 style="color: #5eead4;">📊 Event Log</h4>
            <div id="eventLog" class="event-log"></div>
          </div>
        </div>

        <div class="success" style="margin-top: 30px;">
          <strong>💡 Try This:</strong>
          <ul>
            <li>Set packet loss to 50% and observe retry behavior</li>
            <li>Increase network delay to see message travel time</li>
            <li>Reduce timeout below delay to trigger retransmissions</li>
            <li>Set max retries to 1 and see messages fail faster</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- RESULTS TAB -->
    <div id="results" class="tab-content">
      <div class="section">
        <h2>📊 Results & Testing</h2>

        <h3>Sample Execution - Server Output</h3>
        <div class="code-block">
<pre style="color: #7df59f;">
═══════════════════════════════════════════
  Simple Chat Protocol (SCP) Server v1.0
═══════════════════════════════════════════

🟢 Server listening on port 8080...

✓ Client connected from 127.0.0.1:54321

[14:23:15] RECV: SCP/1.0 | HELLO | id=0 | Alice
         → Connection request from: Alice
[14:23:15] SEND: SCP/1.0 | ACK | id=0 | MSG_RECEIVED

[14:23:20] RECV: SCP/1.0 | MSG | id=1 | Hello Server!
         → Message: Hello Server!
[14:23:20] SEND: SCP/1.0 | ACK | id=1 | MSG_RECEIVED

[14:23:25] RECV: SCP/1.0 | MSG | id=2 | How are you?
         → Message: How are you?
[14:23:25] SEND: SCP/1.0 | ACK | id=2 | MSG_RECEIVED

[14:23:35] RECV: SCP/1.0 | BYE | id=3 | DISCONNECT
         → Client requesting disconnect
[14:23:35] SEND: SCP/1.0 | ACK | id=3 | MSG_RECEIVED

Connection closed by client

═══════════════════════════════════════════
  Server shutdown complete
═══════════════════════════════════════════
</pre>
        </div>

        <h3>Sample Execution - Client Output</h3>
        <div class="code-block">
<pre style="color: #5eead4;">
═══════════════════════════════════════════
  Simple Chat Protocol (SCP) Client v1.0
═══════════════════════════════════════════

Enter your name: Alice
Connecting to server at 127.0.0.1:8080...
✓ Connected to server

─────────────────────────────────────────
Sending connection request...
─────────────────────────────────────────
[14:23:15] SEND (try 1): SCP/1.0 | HELLO | id=0 | Alice
[14:23:15] RECV: SCP/1.0 | ACK | id=0 | MSG_RECEIVED
         ✓ ACK received for id=0

═══════════════════════════════════════════
  Chat session started
  Type 'quit' to exit
═══════════════════════════════════════════

You: Hello Server!
─────────────────────────────────────────
[14:23:20] SEND (try 1): SCP/1.0 | MSG | id=1 | Hello Server!
[14:23:20] RECV: SCP/1.0 | ACK | id=1 | MSG_RECEIVED
         ✓ ACK received for id=1

You: quit

Sending disconnect request...
─────────────────────────────────────────
[14:23:35] SEND (try 1): SCP/1.0 | BYE | id=3 | DISCONNECT
[14:23:35] RECV: SCP/1.0 | ACK | id=3 | MSG_RECEIVED
         ✓ ACK received for id=3

═══════════════════════════════════════════
  Disconnected from server
═══════════════════════════════════════════
</pre>
        </div>

        <h3>Testing Scenarios</h3>

        <h4>Scenario 1: Normal Operation</h4>
        <table>
          <tr>
            <th>Action</th>
            <th>Expected Result</th>
            <th>Status</th>
          </tr>
          <tr>
            <td>Client connects</td>
            <td>HELLO + ACK exchange</td>
            <td>✅ Pass</td>
          </tr>
          <tr>
            <td>Send message</td>
            <td>MSG + ACK exchange</td>
            <td>✅ Pass</td>
          </tr>
          <tr>
            <td>Disconnect</td>
            <td>BYE + ACK exchange</td>
            <td>✅ Pass</td>
          </tr>
        </table>
      </div>
    </div>

    <!-- CONCLUSION TAB -->
    <div id="conclusion" class="tab-content">
      <div class="section">
        <h2>🎓 Conclusion</h2>

        <h3>Project Summary</h3>
        <p>This project successfully demonstrated the design and implementation of a custom application-layer protocol called <strong>Simple Chat Protocol (SCP)</strong>. The protocol enables reliable message exchange between a client and server using TCP sockets in C.</p>

        <h3>Key Achievements</h3>
        <div class="flow-step">
          <strong>✅ Protocol Design</strong>
          <p>Created a well-structured message format with version headers, message types, unique identifiers, and payload data.</p>
        </div>

        <div class="flow-step">
          <strong>✅ Reliability Mechanisms</strong>
          <p>Implemented acknowledgment system, timeout handling, and automatic retransmission to ensure message delivery.</p>
        </div>

        <div class="flow-step">
          <strong>✅ Connection Management</strong>
          <p>Designed proper connection lifecycle with HELLO handshake, message exchange phase, and graceful BYE termination.</p>
        </div>

        <div class="flow-step">
          <strong>✅ Practical Implementation</strong>
          <p>Built working client-server programs in C using socket programming APIs.</p>
        </div>

        <h3>Learning Outcomes</h3>
        <ul>
          <li>Understanding protocol design principles and message structuring</li>
          <li>Hands-on experience with TCP socket programming</li>
          <li>Implementation of reliability mechanisms (timeouts, retries, ACKs)</li>
          <li>Network error handling and debugging techniques</li>
          <li>C programming for systems and network applications</li>
        </ul>

        <div class="success" style="text-align: center; padding: 30px;">
          <h3 style="color: #5eead4; margin-bottom: 15px;">🎉 Project Complete!</h3>
          <p style="font-size: 1.1em;">Thank you for exploring the Simple Chat Protocol.</p>
          <p style="margin-top: 10px;">This project demonstrates core networking concepts in a practical, hands-on way.</p>
        </div>
      </div>
    </div>

    <footer>
      <p><strong>Simple Chat Protocol (SCP) v1.0</strong></p>
      <p>Computer Networks Lab Project - Design Your Own Protocol</p>
      <p style="margin-top: 15px; font-size: 0.9em;">Built with ❤️ for educational purposes | Implementation in C Language</p>
    </footer>
  </div>

  <script src="app.js"></script>
</body>
</html>
